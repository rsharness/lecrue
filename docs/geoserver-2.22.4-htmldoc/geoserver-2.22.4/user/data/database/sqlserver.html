
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Microsoft SQL Server and SQL Azure &#8212; GeoServer 2.22.4 User Manual</title>
    <link rel="stylesheet" href="../../_static/blueprint/screen.css" type="text/css" media="screen, projection" />
    <link rel="stylesheet" href="../../_static/blueprint/print.css" type="text/css" media="print" /> 
    <!--[if IE]>
    <link rel="stylesheet" href="../../_static/blueprint/ie.css" type="text/css" media="screen, projection" />
    <![endif]-->
    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/default.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/geoserver.ico"/>
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Database Connection Pooling" href="connection-pooling.html" />
    <link rel="prev" title="Oracle" href="oracle.html" /> 
  </head><body class="data/database/sqlserver">
<div id="header" class="selfclear">
    <div class="wrap selfclear">
        <div id="logo"><a href="http://geoserver.org">GeoServer</a></div>
        <ul id="top-nav">
            <li class="first"><a href="http://geoserver.org/about/">About</a></li>
            <li><a href="http://geoserver.org/blog">Blog</a></li>
            <li><a href="http://geoserver.org/download/">Download</a></li>
            <li><a href="https://docs.geoserver.org/">Documentation</a></li>
        </ul>

        <form id="quick-search" action="../../search.html" method="get">
            <fieldset>
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
                <input id="quick-search-query" type="text" name="q" accessKey="q" name="searchQuery.queryString" size="25" size="20" tabindex="3" placeholder="Search User Manual&hellip;" />
                <input id="quick-search-submit" type="image" value="Search" src="../../_static/chrome/search_icon_green.png" />
            </fieldset>
        </form>
    </div><!-- /.wrap -->
</div><!-- /#header -->
    <div id="main">
      <div class="wrap selfclear">
        <div id="content-left" class="content-border"></div>
        <div id="content">
        
<ul id="breadcrumbs">
  
    <li><a href="../../index.html">GeoServer 2.22.4 User Manual</a> &raquo;</li>
        <li><a href="../index.html" accesskey="U">Data management</a> &raquo;</li>
        <li><a href="index.html" accesskey="U">Databases</a> &raquo;</li>
    <li>Microsoft SQL Server and SQL Azure</li>
</ul>
        
<ul id="relatedlinks" class="selfclear">
  <li class="first"><a href="connection-pooling.html" title="Database Connection Pooling" accesskey="N">Next</a></li>
  <li>
    <a href="oracle.html" title="Oracle" accesskey="P">Previous</a>|
  </li>
</ul>
          
  <div class="section" id="microsoft-sql-server-and-sql-azure">
<span id="data-sqlserver"></span><h1>Microsoft SQL Server and SQL Azure<a class="headerlink" href="#microsoft-sql-server-and-sql-azure" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>GeoServer does not come built-in with support for SQL Server; it must be installed through an extension. Proceed to <a class="reference internal" href="#sqlserver-install"><span class="std std-ref">Installing the SQL Server extension</span></a> for installation details.</p>
</div>
<p>Microsoft’s <a class="reference external" href="http://www.microsoft.com/sqlserver">SQL Server</a> is a relational database with spatial functionality. SQL Azure is the database option provided in the Azure cloud solution which is in many respects similar to SQL Server.</p>
<div class="section" id="supported-versions">
<h2>Supported versions<a class="headerlink" href="#supported-versions" title="Permalink to this headline">¶</a></h2>
<p>The extension supports SQL Server 2008 - 2019 and SQL Azure.</p>
</div>
<div class="section" id="installing-the-sql-server-extension">
<span id="sqlserver-install"></span><h2>Installing the SQL Server extension<a class="headerlink" href="#installing-the-sql-server-extension" title="Permalink to this headline">¶</a></h2>
<div class="section" id="geoserver-files">
<h3>GeoServer files<a class="headerlink" href="#geoserver-files" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p>Visit the <a class="reference external" href="http://geoserver.org/download">website download</a> page, locate your release, and download: <a class="reference external" href="http://sourceforge.net/projects/geoserver/files/GeoServer/2.22.4/extensions/geoserver-2.22.4-sqlserver-plugin.zip">geoserver-2.22.4-sqlserver-plugin.zip</a></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Ensure to match plugin (example 2.22.4 above) version to the version of the GeoServer instance.</p>
</div>
</li>
<li><p>Extract the contents of the archive into the <code class="file docutils literal notranslate"><span class="pre">WEB-INF/lib</span></code> directory of the GeoServer installation.</p></li>
<li><p>Restart the GeoServer to load the extension.</p></li>
</ol>
</div>
</div>
<div class="section" id="adding-a-sql-server-database">
<h2>Adding a SQL Server database<a class="headerlink" href="#adding-a-sql-server-database" title="Permalink to this headline">¶</a></h2>
<p>Once the extension is properly installed <code class="docutils literal notranslate"><span class="pre">SQL</span> <span class="pre">Server</span></code> will show up as an option when creating a new data store.</p>
<div class="figure align-center" id="id1">
<img alt="../../_images/sqlservercreate.png" src="../../_images/sqlservercreate.png" />
<p class="caption"><span class="caption-text"><em>SQL Server in the list of vector data sources</em></span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="configuring-a-sql-server-data-store">
<h2>Configuring a SQL Server data store<a class="headerlink" href="#configuring-a-sql-server-data-store" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center" id="id2">
<img alt="../../_images/sqlserverconfigure.png" src="../../_images/sqlserverconfigure.png" />
<p class="caption"><span class="caption-text"><em>Configuring a SQL Server data store</em></span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">host</span></code></p></td>
<td><p>The sql server instance host name or ip address, only. Note that <code class="docutils literal notranslate"><span class="pre">server\instance</span></code> notation is not accepted - specify the port below, instead, if you have a non-default instance.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">port</span></code></p></td>
<td><p>The port on which the SQL server instance is accepting connections.  See the <a class="reference internal" href="#port-notes"><span class="std std-ref">note</span></a> below.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">database</span></code></p></td>
<td><p>The name of the database to connect to. Might be left blank if the user connecting to SQL Server has a “default database” set in the user configuration</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">schema</span></code></p></td>
<td><p>The database schema to access tables from (optional).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">user</span></code></p></td>
<td><p>The name of the user to connect to the database as.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">password</span></code></p></td>
<td><p>The password to use when connecting to the database. Leave blank for no password.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">max</span> <span class="pre">connections</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">min</span> <span class="pre">connections</span></code></p>
</td>
<td><p>Connection pool configuration parameters. See the <a class="reference internal" href="connection-pooling.html#connection-pooling"><span class="std std-ref">Database Connection Pooling</span></a> section for details. If you are connecting to SQL Azure make sure to set the <code class="docutils literal notranslate"><span class="pre">validate</span> <span class="pre">connections</span></code> flag as SQL Azure closes inactive connections after a very short delay.</p></td>
</tr>
</tbody>
</table>
<div class="section" id="determining-the-port-used-by-the-sql-server-instance">
<span id="port-notes"></span><h3>Determining the port used by the SQL Server instance<a class="headerlink" href="#determining-the-port-used-by-the-sql-server-instance" title="Permalink to this headline">¶</a></h3>
<p>You can determine the port in use by connecting to your SQL server instance using some other software, and then using <strong class="command">netstat</strong> to display details on network connections.  In the following example on a Windows PC, the port is 2646</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">:</span>\<span class="o">&gt;</span><span class="n">netstat</span> <span class="o">-</span><span class="n">a</span> <span class="o">|</span> <span class="n">find</span> <span class="s2">&quot;sql1&quot;</span>
<span class="n">TCP</span>   <span class="n">DPI908194</span><span class="p">:</span><span class="mi">1918</span>   <span class="n">maittestsql1</span><span class="o">.</span><span class="n">dpi</span><span class="o">.</span><span class="n">nsw</span><span class="o">.</span><span class="n">gov</span><span class="o">.</span><span class="n">au</span><span class="p">:</span><span class="mi">2646</span>   <span class="n">ESTABLISHED</span>
</pre></div>
</div>
</div>
<div class="section" id="using-the-geometry-metadata-table">
<h3>Using the geometry metadata table<a class="headerlink" href="#using-the-geometry-metadata-table" title="Permalink to this headline">¶</a></h3>
<p>The SQL server data store can determine the geometry type and native SRID of a particular column only by data inspection,
by looking at the first row in the table. Of course this is error prone, and works only if there is data in the table.
The administrator can address the above issue by manually creating a geometry metadata table describing each geometry column.
Its presence is indicated via the SQL Server datastore connection parameter named <em>Geometry metadata table</em>
(which may be a simple table name or a schema-qualified one).
The table has the following structure (the table name is flexible, just specify the one chosen in the data store connection parameter):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">GEOMETRY_COLUMNS</span><span class="p">(</span>
   <span class="n">F_TABLE_SCHEMA</span> <span class="n">VARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="n">NOT</span> <span class="n">NULL</span><span class="p">,</span>
   <span class="n">F_TABLE_NAME</span> <span class="n">VARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="n">NOT</span> <span class="n">NULL</span><span class="p">,</span>
   <span class="n">F_GEOMETRY_COLUMN</span> <span class="n">VARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="n">NOT</span> <span class="n">NULL</span><span class="p">,</span>
   <span class="n">COORD_DIMENSION</span> <span class="n">INTEGER</span><span class="p">,</span>
   <span class="n">SRID</span> <span class="n">INTEGER</span> <span class="n">NOT</span> <span class="n">NULL</span><span class="p">,</span>
   <span class="n">TYPE</span> <span class="n">VARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="n">NOT</span> <span class="n">NULL</span><span class="p">,</span>
   <span class="n">UNIQUE</span><span class="p">(</span><span class="n">F_TABLE_SCHEMA</span><span class="p">,</span> <span class="n">F_TABLE_NAME</span><span class="p">,</span> <span class="n">F_GEOMETRY_COLUMN</span><span class="p">),</span>
   <span class="n">CHECK</span><span class="p">(</span><span class="n">TYPE</span> <span class="n">IN</span> <span class="p">(</span><span class="s1">&#39;POINT&#39;</span><span class="p">,</span> <span class="s1">&#39;LINESTRING&#39;</span><span class="p">,</span> <span class="s1">&#39;POLYGON&#39;</span><span class="p">,</span> <span class="s1">&#39;MULTIPOINT&#39;</span><span class="p">,</span> <span class="s1">&#39;MULTILINESTRING&#39;</span><span class="p">,</span> <span class="s1">&#39;MULTIPOLYGON&#39;</span><span class="p">,</span> <span class="s1">&#39;GEOMETRYCOLLECTION&#39;</span><span class="p">)</span> <span class="p">));</span>
</pre></div>
</div>
<p>When the table is present the store first searches it for information about each geometry column
to be classified, and falls back on data inspection only if the table does not contain any information.</p>
</div>
</div>
</div>


        <div class="selfclear pagination-nav">
            <div class="leftwise"><strong>Previous</strong>: <a href="oracle.html" title="previous chapter">Oracle</a></div>
            <div class="rightwise"><strong>Next</strong>: <a href="connection-pooling.html" title="next chapter">Database Connection Pooling</a></div>
        </div>
        </div><!-- /#content> -->
        <div id="content-right" class="content-border"></div>
        
  <div id="sidebar" class="contrast">
      <div id="toc" class="section">
        <h3 class="pngfix"><a href="../../index.html">Table Of Contents</a></h3>
        <ul>
<li><a class="reference internal" href="#">Microsoft SQL Server and SQL Azure</a><ul>
<li><a class="reference internal" href="#supported-versions">Supported versions</a></li>
<li><a class="reference internal" href="#installing-the-sql-server-extension">Installing the SQL Server extension</a><ul>
<li><a class="reference internal" href="#geoserver-files">GeoServer files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-a-sql-server-database">Adding a SQL Server database</a></li>
<li><a class="reference internal" href="#configuring-a-sql-server-data-store">Configuring a SQL Server data store</a><ul>
<li><a class="reference internal" href="#determining-the-port-used-by-the-sql-server-instance">Determining the port used by the SQL Server instance</a></li>
<li><a class="reference internal" href="#using-the-geometry-metadata-table">Using the geometry metadata table</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        <div class="section-footer"></div>
      </div>
        <div class="section">
          <h3>Continue Reading</h3>
          <ul>
            <li>Previous: <a href="oracle.html" title="previous chapter">Oracle</a></li>
            <li>Next: <a href="connection-pooling.html" title="next chapter">Database Connection Pooling</a></li>
          </ul>
        </div>
        <div class="section">
        <h3>This Page</h3>
        <ul class="this-page-menu">
        
        <li><a href="https://github.com/geoserver/geoserver/tree/main/doc/en/user/source/data/database/sqlserver.rst">Edit</a></li>
        </ul>
        </div>
      <div class="section">
        <h3>Known GeoServer issues</h3>
        <ul class="this-page-menu">
          <li><a href="https://osgeo-org.atlassian.net/projects/GEOS/summary">Jira issue tracker</a></li>
        </ul>
      </div>
  </div><!-- /#sidebar -->
    </div><!-- /.wrap> -->
  </div><!-- /#main -->
<div id="footer">
    <div class="wrap">
        &copy; Copyright 2023, Open Source Geospatial Foundation. License <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution</a>.
        Last updated on Jun 18, 2023.
        Created using <a href="http://www.sphinx-doc.org/">Sphinx</a>.
    </div><!-- /.wrap> -->
</div><!-- /#footer -->
  </body>
</html>