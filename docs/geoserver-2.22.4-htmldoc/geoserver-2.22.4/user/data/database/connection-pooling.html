
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Database Connection Pooling &#8212; GeoServer 2.22.4 User Manual</title>
    <link rel="stylesheet" href="../../_static/blueprint/screen.css" type="text/css" media="screen, projection" />
    <link rel="stylesheet" href="../../_static/blueprint/print.css" type="text/css" media="print" /> 
    <!--[if IE]>
    <link rel="stylesheet" href="../../_static/blueprint/ie.css" type="text/css" media="screen, projection" />
    <![endif]-->
    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/default.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/geoserver.ico"/>
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="JNDI" href="jndi.html" />
    <link rel="prev" title="Microsoft SQL Server and SQL Azure" href="sqlserver.html" /> 
  </head><body class="data/database/connection-pooling">
<div id="header" class="selfclear">
    <div class="wrap selfclear">
        <div id="logo"><a href="http://geoserver.org">GeoServer</a></div>
        <ul id="top-nav">
            <li class="first"><a href="http://geoserver.org/about/">About</a></li>
            <li><a href="http://geoserver.org/blog">Blog</a></li>
            <li><a href="http://geoserver.org/download/">Download</a></li>
            <li><a href="https://docs.geoserver.org/">Documentation</a></li>
        </ul>

        <form id="quick-search" action="../../search.html" method="get">
            <fieldset>
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
                <input id="quick-search-query" type="text" name="q" accessKey="q" name="searchQuery.queryString" size="25" size="20" tabindex="3" placeholder="Search User Manual&hellip;" />
                <input id="quick-search-submit" type="image" value="Search" src="../../_static/chrome/search_icon_green.png" />
            </fieldset>
        </form>
    </div><!-- /.wrap -->
</div><!-- /#header -->
    <div id="main">
      <div class="wrap selfclear">
        <div id="content-left" class="content-border"></div>
        <div id="content">
        
<ul id="breadcrumbs">
  
    <li><a href="../../index.html">GeoServer 2.22.4 User Manual</a> &raquo;</li>
        <li><a href="../index.html" accesskey="U">Data management</a> &raquo;</li>
        <li><a href="index.html" accesskey="U">Databases</a> &raquo;</li>
    <li>Database Connection Pooling</li>
</ul>
        
<ul id="relatedlinks" class="selfclear">
  <li class="first"><a href="jndi.html" title="JNDI" accesskey="N">Next</a></li>
  <li>
    <a href="sqlserver.html" title="Microsoft SQL Server and SQL Azure" accesskey="P">Previous</a>|
  </li>
</ul>
          
  <div class="section" id="database-connection-pooling">
<span id="connection-pooling"></span><h1>Database Connection Pooling<a class="headerlink" href="#database-connection-pooling" title="Permalink to this headline">¶</a></h1>
<p>When serving data from a spatial database <em>connection pooling</em> is an important aspect of achieving good performance. When GeoServer serves a request that involves loading data from a database table, a connection must first be established with the database. This connection comes with a cost as it takes time to set up such a connection.</p>
<p>The purpose served by a connection pool is to maintain connection to an underlying database between requests. The benefit of which is that connection setup only need to occur once on the first request. Subsequent requests use existing connections and achieve a performance benefit as a result.</p>
<p>Whenever a data store backed by a database is added to GeoServer an internal connection pool is created. This connection pool is configurable.</p>
<div class="section" id="connection-pool-options">
<h2>Connection pool options<a class="headerlink" href="#connection-pool-options" title="Permalink to this headline">¶</a></h2>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>max connections</p></td>
<td><p>The maximum number of connections the pool can hold. When the maximum number of connections is exceeded, additional requests that require a database connection will be halted until a connection from the pool becomes available. The maximum number of connections limits the number of concurrent requests that can be made against the database.</p></td>
</tr>
<tr class="row-even"><td><p>min connections</p></td>
<td><p>The minimum number of connections the pool will hold. This number of connections is held even when there are no active requests. When this number of connections is exceeded due to serving requests additional connections are opened until the pool reaches its maximum size (described above).</p></td>
</tr>
<tr class="row-odd"><td><p>validate connections</p></td>
<td><p>Flag indicating whether connections from the pool should be validated before they are used. A connection in the pool can become invalid for a number of reasons including network breakdown, database server timeout, etc..
The benefit of setting this flag is that an invalid connection will never be used which can prevent client errors. The downside of setting the flag is that a performance penalty is paid in order to validate connections.</p></td>
</tr>
<tr class="row-even"><td><p>fetch size</p></td>
<td><p>The number of records read from the database in each network exchange. If set too low (&lt;50) network latency will affect negatively performance, if set too high it might consume a significant portion of GeoServer memory and push it towards an <code class="docutils literal notranslate"><span class="pre">Out</span> <span class="pre">Of</span> <span class="pre">Memory</span></code> error. Defaults to 1000.</p></td>
</tr>
<tr class="row-odd"><td><p>connection timeout</p></td>
<td><p>Time, in seconds, the connection pool will wait before giving up its attempt to get a new connection from the database. Defaults to 20 seconds.</p></td>
</tr>
<tr class="row-even"><td><p>Test while idle</p></td>
<td><p>Periodically test if the connections are still valid also while idle in the pool. Sometimes performing a test query using an idle connection can make the datastore unavailable for a while. Often the cause of this troublesome behaviour is related to a network firewall placed between GeoServer and the Database that force the closing of the underlying idle TCP connections.</p></td>
</tr>
<tr class="row-odd"><td><p>Evictor run periodicity</p></td>
<td><p>Number of seconds between idle object evictor runs.</p></td>
</tr>
<tr class="row-even"><td><p>Max connection idle time</p></td>
<td><p>Number of seconds a connection needs to stay idle before the evictor starts to consider closing it.</p></td>
</tr>
<tr class="row-odd"><td><p>Evictor tests per run</p></td>
<td><p>Number of connections checked by the idle connection evictor for each of its runs.</p></td>
</tr>
</tbody>
</table>
</div>
</div>


        <div class="selfclear pagination-nav">
            <div class="leftwise"><strong>Previous</strong>: <a href="sqlserver.html" title="previous chapter">Microsoft SQL Server and SQL Azure</a></div>
            <div class="rightwise"><strong>Next</strong>: <a href="jndi.html" title="next chapter">JNDI</a></div>
        </div>
        </div><!-- /#content> -->
        <div id="content-right" class="content-border"></div>
        
  <div id="sidebar" class="contrast">
      <div id="toc" class="section">
        <h3 class="pngfix"><a href="../../index.html">Table Of Contents</a></h3>
        <ul>
<li><a class="reference internal" href="#">Database Connection Pooling</a><ul>
<li><a class="reference internal" href="#connection-pool-options">Connection pool options</a></li>
</ul>
</li>
</ul>

        <div class="section-footer"></div>
      </div>
        <div class="section">
          <h3>Continue Reading</h3>
          <ul>
            <li>Previous: <a href="sqlserver.html" title="previous chapter">Microsoft SQL Server and SQL Azure</a></li>
            <li>Next: <a href="jndi.html" title="next chapter">JNDI</a></li>
          </ul>
        </div>
        <div class="section">
        <h3>This Page</h3>
        <ul class="this-page-menu">
        
        <li><a href="https://github.com/geoserver/geoserver/tree/main/doc/en/user/source/data/database/connection-pooling.rst">Edit</a></li>
        </ul>
        </div>
      <div class="section">
        <h3>Known GeoServer issues</h3>
        <ul class="this-page-menu">
          <li><a href="https://osgeo-org.atlassian.net/projects/GEOS/summary">Jira issue tracker</a></li>
        </ul>
      </div>
  </div><!-- /#sidebar -->
    </div><!-- /.wrap> -->
  </div><!-- /#main -->
<div id="footer">
    <div class="wrap">
        &copy; Copyright 2023, Open Source Geospatial Foundation. License <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution</a>.
        Last updated on Jun 18, 2023.
        Created using <a href="http://www.sphinx-doc.org/">Sphinx</a>.
    </div><!-- /.wrap> -->
</div><!-- /#footer -->
  </body>
</html>