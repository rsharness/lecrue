
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Authentication with LDAP against ActiveDirectory &#8212; GeoServer 2.22.4 User Manual</title>
    <link rel="stylesheet" href="../../../_static/blueprint/screen.css" type="text/css" media="screen, projection" />
    <link rel="stylesheet" href="../../../_static/blueprint/print.css" type="text/css" media="print" /> 
    <!--[if IE]>
    <link rel="stylesheet" href="../../../_static/blueprint/ie.css" type="text/css" media="screen, projection" />
    <![endif]-->
    
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/default.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../../_static/geoserver.ico"/>
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Configuring Digest Authentication" href="../digest/index.html" />
    <link rel="prev" title="Authentication with LDAP" href="../ldap/index.html" /> 
  </head><body class="security/tutorials/activedirectory/index">
<div id="header" class="selfclear">
    <div class="wrap selfclear">
        <div id="logo"><a href="http://geoserver.org">GeoServer</a></div>
        <ul id="top-nav">
            <li class="first"><a href="http://geoserver.org/about/">About</a></li>
            <li><a href="http://geoserver.org/blog">Blog</a></li>
            <li><a href="http://geoserver.org/download/">Download</a></li>
            <li><a href="https://docs.geoserver.org/">Documentation</a></li>
        </ul>

        <form id="quick-search" action="../../../search.html" method="get">
            <fieldset>
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
                <input id="quick-search-query" type="text" name="q" accessKey="q" name="searchQuery.queryString" size="25" size="20" tabindex="3" placeholder="Search User Manual&hellip;" />
                <input id="quick-search-submit" type="image" value="Search" src="../../../_static/chrome/search_icon_green.png" />
            </fieldset>
        </form>
    </div><!-- /.wrap -->
</div><!-- /#header -->
    <div id="main">
      <div class="wrap selfclear">
        <div id="content-left" class="content-border"></div>
        <div id="content">
        
<ul id="breadcrumbs">
  
    <li><a href="../../../index.html">GeoServer 2.22.4 User Manual</a> &raquo;</li>
        <li><a href="../../index.html" accesskey="U">Security</a> &raquo;</li>
        <li><a href="../index.html" accesskey="U">Tutorials</a> &raquo;</li>
    <li>Authentication with LDAP against ActiveDirectory</li>
</ul>
        
<ul id="relatedlinks" class="selfclear">
  <li class="first"><a href="../digest/index.html" title="Configuring Digest Authentication" accesskey="N">Next</a></li>
  <li>
    <a href="../ldap/index.html" title="Authentication with LDAP" accesskey="P">Previous</a>|
  </li>
</ul>
          
  <div class="section" id="authentication-with-ldap-against-activedirectory">
<span id="security-tutorials-activedirectory"></span><h1>Authentication with LDAP against ActiveDirectory<a class="headerlink" href="#authentication-with-ldap-against-activedirectory" title="Permalink to this headline">¶</a></h1>
<p>This tutorial explains how to use GeoServer LDAP support to connect to a Windows Domain using ActiveDirectory as an LDAP server. It is recommended that the
<a class="reference internal" href="../../auth/providers.html#security-auth-provider-ldap"><span class="std std-ref">LDAP authentication</span></a> section be read before proceeding.</p>
<div class="section" id="windows-server-and-activedirectory">
<h2>Windows Server and ActiveDirectory<a class="headerlink" href="#windows-server-and-activedirectory" title="Permalink to this headline">¶</a></h2>
<p>Active Directory is just another LDAP server implementation, but has some features that we must know to successfully use it with GeoServer LDAP authentication.
In this tutorial we will assume to have a Windows Server Domain Controller with ActiveDirectory named <code class="docutils literal notranslate"><span class="pre">domain-controller</span></code> for a domain named <code class="docutils literal notranslate"><span class="pre">ad.local</span></code>.
If your environment uses different names (and it surely will) use your real names where needed.</p>
<p>We will also assume that:</p>
<blockquote>
<div><ul class="simple">
<li><p>a group named <code class="docutils literal notranslate"><span class="pre">GISADMINGROUP</span></code> exists.</p></li>
<li><p>a user named <code class="docutils literal notranslate"><span class="pre">GISADMIN</span></code> exists, has password <code class="docutils literal notranslate"><span class="pre">secret</span></code>, and belongs to the <code class="docutils literal notranslate"><span class="pre">GISADMINGROUP</span></code> group.</p></li>
<li><p>a user named <code class="docutils literal notranslate"><span class="pre">GISUSER</span></code> exists, has password <code class="docutils literal notranslate"><span class="pre">secret</span></code>, and does NOT belong to the <code class="docutils literal notranslate"><span class="pre">GISADMINGROUP</span></code> group.</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ADMINISTRATOR cannot be generally used as the admin group name with ActiveDirectory, because Administrator is the root user name in Windows environment.</p>
</div>
</div>
<div class="section" id="configure-the-ldap-authentication-provider">
<h2>Configure the LDAP authentication provider<a class="headerlink" href="#configure-the-ldap-authentication-provider" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p>Start GeoServer and login to the web admin interface as the <code class="docutils literal notranslate"><span class="pre">admin</span></code> user.</p></li>
<li><p>Click the <code class="docutils literal notranslate"><span class="pre">Authentication</span></code> link located under the <code class="docutils literal notranslate"><span class="pre">Security</span></code> section of
the navigation sidebar.</p>
<blockquote>
<div><div class="figure align-center">
<img alt="../../../_images/ldap1.jpg" src="../../../_images/ldap1.jpg" />
</div>
</div></blockquote>
</li>
<li><p>Scroll down to the <code class="docutils literal notranslate"><span class="pre">Authentication</span> <span class="pre">Providers</span></code> panel and click the <code class="docutils literal notranslate"><span class="pre">Add</span> <span class="pre">new</span></code> link.</p>
<blockquote>
<div><div class="figure align-center">
<img alt="../../../_images/ldap2.jpg" src="../../../_images/ldap2.jpg" />
</div>
</div></blockquote>
</li>
<li><p>Click the <code class="docutils literal notranslate"><span class="pre">LDAP</span></code> link.</p>
<blockquote>
<div><div class="figure align-center">
<img alt="../../../_images/ldap3.jpg" src="../../../_images/ldap3.jpg" />
</div>
</div></blockquote>
</li>
<li><p>Fill in the fields of the settings form as follows:</p>
<ul class="simple">
<li><p>Set <code class="docutils literal notranslate"><span class="pre">Name</span></code> to “ad-ldap”</p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">Server</span> <span class="pre">URL</span></code>  to “<a class="reference external" href="ldap://domain-controller/dc=ad,dc=local">ldap://domain-controller/dc=ad,dc=local</a></p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">Filter</span> <span class="pre">used</span> <span class="pre">to</span> <span class="pre">lookup</span> <span class="pre">user</span></code> to <code class="docutils literal notranslate"><span class="pre">(|(userPrincipalName={0})(sAMAccountName={1}))</span></code></p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">Format</span> <span class="pre">used</span> <span class="pre">for</span> <span class="pre">user</span> <span class="pre">login</span> <span class="pre">name</span></code> to “<a class="reference external" href="mailto:{0}&#37;&#52;&#48;ad&#46;local">{0}<span>&#64;</span>ad<span>&#46;</span>local</a>”</p></li>
<li><p>Check <code class="docutils literal notranslate"><span class="pre">Use</span> <span class="pre">LDAP</span> <span class="pre">groups</span> <span class="pre">for</span> <span class="pre">authorization</span></code></p></li>
<li><p>Check <code class="docutils literal notranslate"><span class="pre">Bind</span> <span class="pre">user</span> <span class="pre">before</span> <span class="pre">searching</span> <span class="pre">for</span> <span class="pre">groups</span></code></p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">Group</span> <span class="pre">to</span> <span class="pre">use</span> <span class="pre">as</span> <span class="pre">ADMIN</span></code> to “GISADMINGROUP”</p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">Group</span> <span class="pre">search</span> <span class="pre">base</span></code> to “cn=Users”</p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">Group</span> <span class="pre">search</span> <span class="pre">filter</span></code> to “member={0}”</p></li>
</ul>
</li>
<li><p>Test the LDAP connection by entering the username “GISADMIN” and password “secret”
in the connection test form located on the right and click the
<code class="docutils literal notranslate"><span class="pre">Test</span> <span class="pre">Connection</span></code> button.</p>
<div class="figure align-center">
<img alt="../../../_images/ad1.jpg" src="../../../_images/ad1.jpg" />
</div>
<p>A successful connection should be reported at the top of the page.</p>
</li>
<li><p>Save.</p></li>
<li><p>Back on the authentication page scroll down to the <code class="docutils literal notranslate"><span class="pre">Provider</span> <span class="pre">Chain</span></code> panel
and move the <code class="docutils literal notranslate"><span class="pre">ad-ldap</span></code> provider from <code class="docutils literal notranslate"><span class="pre">Available</span></code> to <code class="docutils literal notranslate"><span class="pre">Selected</span></code>.</p>
<div class="figure align-center">
<img alt="../../../_images/ad2.jpg" src="../../../_images/ad2.jpg" />
</div>
</li>
<li><p>Save.</p></li>
</ol>
</div>
<div class="section" id="test-a-ldap-login">
<h2>Test a LDAP login<a class="headerlink" href="#test-a-ldap-login" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p>Navigate to the GeoServer home page and log out of the admin account.</p></li>
<li><p>Login as the user “GISUSER” with the password “secret”.</p>
<div class="figure align-center">
<img alt="../../../_images/ad3.jpg" src="../../../_images/ad3.jpg" />
</div>
</li>
</ol>
<p>Logging in as GISUSER doesn’t yield any administrative functionality because the GISUSER account has not been mapped to the administrator role. In the next section
GeoServer will be configured to map groups from the LDAP database to roles.</p>
<p>Now we will login with a user having administrative rights.</p>
<ol class="arabic simple">
<li><p>Navigate to the GeoServer home page and log out of the account.</p></li>
<li><p>Login as the user “GISADMIN” with the password “secret”.</p></li>
</ol>
<p>Once logged in full administrative functionality should be available.</p>
</div>
<div class="section" id="configure-the-ldap-role-service">
<h2>Configure the LDAP role service<a class="headerlink" href="#configure-the-ldap-role-service" title="Permalink to this headline">¶</a></h2>
<p>An additional step permits to configure a role service to get GeoServer roles
from the LDAP repository and allow access rights to be assigned to those roles.</p>
<ol class="arabic">
<li><p>Click the <code class="docutils literal notranslate"><span class="pre">Users,Group,Roles</span></code> link located under the <code class="docutils literal notranslate"><span class="pre">Security</span></code> section
of the navigation sidebar.</p></li>
<li><p>Click the <code class="docutils literal notranslate"><span class="pre">Add</span> <span class="pre">new</span> <span class="pre">link</span></code> under the  <code class="docutils literal notranslate"><span class="pre">Role</span> <span class="pre">Services</span></code> section.</p></li>
<li><p>Click the <code class="docutils literal notranslate"><span class="pre">LDAP</span></code> option under the  <code class="docutils literal notranslate"><span class="pre">New</span> <span class="pre">Role</span> <span class="pre">Service</span></code> section.</p>
<div class="figure align-center">
<img alt="../../../_images/ldap14.jpg" src="../../../_images/ldap14.jpg" />
</div>
</li>
<li><p>Enter <code class="docutils literal notranslate"><span class="pre">ldapadrs</span></code> in the  <code class="docutils literal notranslate"><span class="pre">Name</span></code> text field.</p></li>
<li><p>Enter <code class="docutils literal notranslate"><span class="pre">ldap://domain-controller/dc=ad,dc=local</span></code> in the  <code class="docutils literal notranslate"><span class="pre">Server</span> <span class="pre">URL</span></code> text field.</p></li>
<li><p>Enter <code class="docutils literal notranslate"><span class="pre">CN=Users</span></code> in the  <code class="docutils literal notranslate"><span class="pre">Group</span> <span class="pre">search</span> <span class="pre">base</span></code> text field.</p></li>
<li><p>Enter <code class="docutils literal notranslate"><span class="pre">member={1},dc=ad,dc=local</span></code> in the  <code class="docutils literal notranslate"><span class="pre">Group</span> <span class="pre">user</span> <span class="pre">membership</span> <span class="pre">search</span> <span class="pre">filter</span></code> text field.</p></li>
<li><p>Enter <code class="docutils literal notranslate"><span class="pre">objectClass=group</span></code> in the  <code class="docutils literal notranslate"><span class="pre">All</span> <span class="pre">groups</span> <span class="pre">search</span> <span class="pre">filter</span></code> text field.</p></li>
<li><p>Enter <code class="docutils literal notranslate"><span class="pre">sAMAccountName={0}</span></code> in the  <code class="docutils literal notranslate"><span class="pre">Filter</span> <span class="pre">used</span> <span class="pre">to</span> <span class="pre">lookup</span> <span class="pre">user</span></code> text field.</p></li>
</ol>
<p>Then we need to a choose a user to authenticate on the server (many LDAP server don’t allow anonymous data lookup).</p>
<ol class="arabic simple">
<li><p>Check the <code class="docutils literal notranslate"><span class="pre">Authenticate</span> <span class="pre">to</span> <span class="pre">extract</span> <span class="pre">roles</span></code> checkbox.</p></li>
<li><p>Enter <code class="docutils literal notranslate"><span class="pre">GISADMIN&#64;ad.local</span></code> in the  <code class="docutils literal notranslate"><span class="pre">Username</span></code> text field.</p></li>
<li><p>Enter <code class="docutils literal notranslate"><span class="pre">secret</span></code> in the  <code class="docutils literal notranslate"><span class="pre">Password</span></code> text field.</p></li>
<li><p>Save.</p></li>
<li><p>Click the <code class="docutils literal notranslate"><span class="pre">ldapadrs</span></code> role service item under the  <code class="docutils literal notranslate"><span class="pre">Role</span> <span class="pre">Services</span></code> section.</p></li>
<li><p>Select <code class="docutils literal notranslate"><span class="pre">ROLE_DOMAIN</span> <span class="pre">ADMINS</span></code> from the <code class="docutils literal notranslate"><span class="pre">Administrator</span> <span class="pre">role</span></code> combo-box.</p></li>
<li><p>Select <code class="docutils literal notranslate"><span class="pre">ROLE_DOMAIN</span> <span class="pre">ADMINS</span></code> from the <code class="docutils literal notranslate"><span class="pre">Group</span> <span class="pre">administrator</span> <span class="pre">role</span></code> combo-box.</p></li>
<li><p>Save again.</p></li>
</ol>
<p>You should now be able to see and assign the new ActiveDirectory roles wherever an <code class="docutils literal notranslate"><span class="pre">Available</span> <span class="pre">Roles</span></code> list is shown (for example in the <code class="docutils literal notranslate"><span class="pre">Data</span></code> and <code class="docutils literal notranslate"><span class="pre">Services</span></code> rules sections.</p>
</div>
</div>


        <div class="selfclear pagination-nav">
            <div class="leftwise"><strong>Previous</strong>: <a href="../ldap/index.html" title="previous chapter">Authentication with LDAP</a></div>
            <div class="rightwise"><strong>Next</strong>: <a href="../digest/index.html" title="next chapter">Configuring Digest Authentication</a></div>
        </div>
        </div><!-- /#content> -->
        <div id="content-right" class="content-border"></div>
        
  <div id="sidebar" class="contrast">
      <div id="toc" class="section">
        <h3 class="pngfix"><a href="../../../index.html">Table Of Contents</a></h3>
        <ul>
<li><a class="reference internal" href="#">Authentication with LDAP against ActiveDirectory</a><ul>
<li><a class="reference internal" href="#windows-server-and-activedirectory">Windows Server and ActiveDirectory</a></li>
<li><a class="reference internal" href="#configure-the-ldap-authentication-provider">Configure the LDAP authentication provider</a></li>
<li><a class="reference internal" href="#test-a-ldap-login">Test a LDAP login</a></li>
<li><a class="reference internal" href="#configure-the-ldap-role-service">Configure the LDAP role service</a></li>
</ul>
</li>
</ul>

        <div class="section-footer"></div>
      </div>
        <div class="section">
          <h3>Continue Reading</h3>
          <ul>
            <li>Previous: <a href="../ldap/index.html" title="previous chapter">Authentication with LDAP</a></li>
            <li>Next: <a href="../digest/index.html" title="next chapter">Configuring Digest Authentication</a></li>
          </ul>
        </div>
        <div class="section">
        <h3>This Page</h3>
        <ul class="this-page-menu">
        
        <li><a href="https://github.com/geoserver/geoserver/tree/main/doc/en/user/source/security/tutorials/activedirectory/index.rst">Edit</a></li>
        </ul>
        </div>
      <div class="section">
        <h3>Known GeoServer issues</h3>
        <ul class="this-page-menu">
          <li><a href="https://osgeo-org.atlassian.net/projects/GEOS/summary">Jira issue tracker</a></li>
        </ul>
      </div>
  </div><!-- /#sidebar -->
    </div><!-- /.wrap> -->
  </div><!-- /#main -->
<div id="footer">
    <div class="wrap">
        &copy; Copyright 2023, Open Source Geospatial Foundation. License <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution</a>.
        Last updated on Jun 18, 2023.
        Created using <a href="http://www.sphinx-doc.org/">Sphinx</a>.
    </div><!-- /.wrap> -->
</div><!-- /#footer -->
  </body>
</html>