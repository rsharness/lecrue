
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>URL Checks &#8212; GeoServer 2.22.4 User Manual</title>
    <link rel="stylesheet" href="../_static/blueprint/screen.css" type="text/css" media="screen, projection" />
    <link rel="stylesheet" href="../_static/blueprint/print.css" type="text/css" media="print" /> 
    <!--[if IE]>
    <link rel="stylesheet" href="../_static/blueprint/ie.css" type="text/css" media="screen, projection" />
    <![endif]-->
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/default.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/geoserver.ico"/>
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Disabling security" href="disable.html" />
    <link rel="prev" title="REST Security" href="rest.html" /> 
  </head><body class="security/urlchecks">
<div id="header" class="selfclear">
    <div class="wrap selfclear">
        <div id="logo"><a href="http://geoserver.org">GeoServer</a></div>
        <ul id="top-nav">
            <li class="first"><a href="http://geoserver.org/about/">About</a></li>
            <li><a href="http://geoserver.org/blog">Blog</a></li>
            <li><a href="http://geoserver.org/download/">Download</a></li>
            <li><a href="https://docs.geoserver.org/">Documentation</a></li>
        </ul>

        <form id="quick-search" action="../search.html" method="get">
            <fieldset>
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
                <input id="quick-search-query" type="text" name="q" accessKey="q" name="searchQuery.queryString" size="25" size="20" tabindex="3" placeholder="Search User Manual&hellip;" />
                <input id="quick-search-submit" type="image" value="Search" src="../_static/chrome/search_icon_green.png" />
            </fieldset>
        </form>
    </div><!-- /.wrap -->
</div><!-- /#header -->
    <div id="main">
      <div class="wrap selfclear">
        <div id="content-left" class="content-border"></div>
        <div id="content">
        
<ul id="breadcrumbs">
  
    <li><a href="../index.html">GeoServer 2.22.4 User Manual</a> &raquo;</li>
        <li><a href="index.html" accesskey="U">Security</a> &raquo;</li>
    <li>URL Checks</li>
</ul>
        
<ul id="relatedlinks" class="selfclear">
  <li class="first"><a href="disable.html" title="Disabling security" accesskey="N">Next</a></li>
  <li>
    <a href="rest.html" title="REST Security" accesskey="P">Previous</a>|
  </li>
</ul>
          
  <div class="section" id="url-checks">
<span id="security-urlchecks"></span><h1>URL Checks<a class="headerlink" href="#url-checks" title="Permalink to this headline">¶</a></h1>
<p>The <span class="guilabel">URL External Access Checks</span> page controls the checks that are performed on user provided URLs that
GeoServer will use to access remote resources.</p>
<p>Currently, the checks are performed on the following functionality:</p>
<ul class="simple">
<li><p>WMS GetMap requests with remote SLD stylesheets (<code class="docutils literal notranslate"><span class="pre">sld</span></code> parameter)</p></li>
<li><p>Remote icons referenced by styles (access to icons in the data directory is always allowed)</p></li>
<li><p>WMS GetMap in feature portrayal mode (<code class="docutils literal notranslate"><span class="pre">REMOTE_OWS</span></code> and <code class="docutils literal notranslate"><span class="pre">REMOTE_OWS_TYPE</span></code> parameters)</p></li>
<li><p>WPS remote inputs, either as GET or POST requests</p></li>
</ul>
<p>Check this page for any additional remote service access checks added in the future.</p>
<div class="section" id="configuration-of-url-checks">
<h2>Configuration of URL checks<a class="headerlink" href="#configuration-of-url-checks" title="Permalink to this headline">¶</a></h2>
<p>Navigate to <span class="menuselection">Data &gt; URL Checks</span> page to manage and configure URL Checks.</p>
<div class="figure align-default" id="id1">
<img alt="../_images/urlchecks.png" src="../_images/urlchecks.png" />
<p class="caption"><span class="caption-text">URL Checks table</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<p>Use the <span class="guilabel">Enable/Disable URL Checks</span> enable this safety feature:</p>
<ul>
<li><p>When the <span class="guilabel">URL checks are enabled</span> checkbox is enabled, URL checks are performed to limit GeoServer access to remote resources as outlined above.</p>
<p>Enabling URL checks is recommended to limit normal Open Web Service protocols interaction being used for Cross Site Scripting attacks.</p>
</li>
<li><p>When checkbox disabled, <span class="guilabel">URL checks are NOT enabled</span>, GeoServer is provided unrestricted access to remote resources.</p>
<p>Disabling URL Checks is not a secure or recommended setting.</p>
</li>
</ul>
</div>
<div class="section" id="adding-a-regular-expression-based-check">
<h2>Adding a regular expression based check<a class="headerlink" href="#adding-a-regular-expression-based-check" title="Permalink to this headline">¶</a></h2>
<p>The buttons for adding and removing URL checks can be found at the top of the <span class="guilabel">URL Check list</span> table.</p>
<p>To add a URL Check, press the <span class="guilabel">Add new URL check</span> button. You will be prompted to enter URL check details (as described in <a class="reference internal" href="#security-urlchecks-edit"><span class="std std-ref">Editing a URL Check</span></a> below).</p>
</div>
<div class="section" id="removing-a-regular-expression-based-check">
<h2>Removing a regular expression based check<a class="headerlink" href="#removing-a-regular-expression-based-check" title="Permalink to this headline">¶</a></h2>
<p>To remove a URL Check, select the checkbox next to one or more rows in the <span class="guilabel">URL Check list</span> table.
Press the <span class="guilabel">Remove selected URL checks</span> button to remove. You will be asked to confirm or cancel the removal. Pressing <span class="guilabel">OK</span> removes the selected URL Checks.</p>
</div>
<div class="section" id="editing-a-url-check">
<span id="security-urlchecks-edit"></span><h2>Editing a URL Check<a class="headerlink" href="#editing-a-url-check" title="Permalink to this headline">¶</a></h2>
<p>Regular Expression URL checks can be configured, with the following parameters for each check:</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Name</p></td>
<td><p>Name for the check, used to identify it in the list.</p></td>
</tr>
<tr class="row-odd"><td><p>Description</p></td>
<td><p>Description of the check, for later reference.</p></td>
</tr>
<tr class="row-even"><td><p>Regular Expression</p></td>
<td><p>A regular expression used to match allowed URLs</p></td>
</tr>
<tr class="row-odd"><td><p>Enabled</p></td>
<td><p>Check box to enable or disable the check</p></td>
</tr>
</tbody>
</table>
<div class="figure align-default" id="id2">
<img alt="../_images/urlchecks-edit.png" src="../_images/urlchecks-edit.png" />
<p class="caption"><span class="caption-text">Configure Regular Expression URL check</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="testing-url-checks">
<h2>Testing URL checks<a class="headerlink" href="#testing-url-checks" title="Permalink to this headline">¶</a></h2>
<p>The <span class="guilabel">Test URL Checks with external URL</span> form allows a URL to be checked, reporting if access is allowed or disallowed.</p>
<p>Test URL Checks form:</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>URL to check</p></td>
<td><p>Supply URL of external resource to check if access is allowed</p></td>
</tr>
</tbody>
</table>
<p>Press the <span class="guilabel">Test URL</span> button to perform the checks. If at least one URL Check matches the URL, it will be allowed and the test will indicate the URL Check permitting access. Otherwise it will be rejected and the test will indicate that no URL Check matched.</p>
<div class="figure align-default" id="id3">
<img alt="../_images/urlchecks-test.png" src="../_images/urlchecks-test.png" />
<p class="caption"><span class="caption-text">Test URL Checks with external URL</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="example-regex-patterns">
<h2>Example RegEx Patterns<a class="headerlink" href="#example-regex-patterns" title="Permalink to this headline">¶</a></h2>
<p>The most common pattern allows matching a given host name to allow external graphics from a remote server. This pattern uses <code class="docutils literal notranslate"><span class="pre">^</span></code> to mark the start, the host URL, <code class="docutils literal notranslate"><span class="pre">.*</span></code> to match anything, and <code class="docutils literal notranslate"><span class="pre">$</span></code> to end - as shown in the in following pattern:</p>
<p><code class="docutils literal notranslate"><span class="pre">^https://styles\.server\.net/.*$</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">styles</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">logo</span><span class="o">.</span><span class="n">png</span>
</pre></div>
</div>
<p>To allow external graphics from a specific directory on a remote server:</p>
<p><code class="docutils literal notranslate"><span class="pre">^https://styles\.server\.net/icons/.*$</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">styles</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">icons</span><span class="o">/</span><span class="n">forest</span><span class="o">.</span><span class="n">png</span>
</pre></div>
</div>
<p>When working with external graphics making use of SVG parameters use <code class="docutils literal notranslate"><span class="pre">(\?.*)?$</span></code> to optionally allow any query parameters after <code class="docutils literal notranslate"><span class="pre">?</span></code>:</p>
<p><code class="docutils literal notranslate"><span class="pre">^https://styles\.server\.net/icons/.*(\?.*)?$</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>https://styles.server.net/icons/forest.png
https://styles.server.net/icons/forest.svg?color=darkgreen
</pre></div>
</div>
<p>When obtaining content from an API <code class="docutils literal notranslate"><span class="pre">\?.*</span></code> is used (as there is no need to support relative paths). As an example <code class="docutils literal notranslate"><span class="pre">/geoserver/ows\?</span></code> is used below to access the GeoServer Open Web Service API:</p>
<p><code class="docutils literal notranslate"><span class="pre">^https?://localhost:8080/geoserver/ows\?.*$</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://localhost:8080/geoserver/ows?service=WMS&amp;version=1.3.0&amp;request=GetCapabilities
</pre></div>
</div>
<p>To allow for GeoServer virtual web services <code class="docutils literal notranslate"><span class="pre">(\w+/)?</span></code> is used for optional workspace name:</p>
<p><code class="docutils literal notranslate"><span class="pre">^https?://localhost:8080/geoserver/(\w+/)?ows\?.*$</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://localhost:8080/geoserver/ows?service=WMS&amp;version=1.3.0&amp;request=GetCapabilities
http://localhost:8080/geoserver/ne/ows?service=WMS&amp;version=1.3.0&amp;request=GetCapabilities
</pre></div>
</div>
<p>To limit to Web Feature Service <code class="docutils literal notranslate"><span class="pre">?.*SERVICE=WFS.*</span></code> is used to restrict query parameter:</p>
<p><code class="docutils literal notranslate"><span class="pre">^https?://localhost:8080/geoserver/(\w+/)?ows\?.*SERVICE=WFS.*?$</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://localhost:8080/geoserver/tiger/ows?SERVICE=WFS&amp;VERSION=1.0.0&amp;REQUEST=GetFeature&amp;TYPENAME=giant_polygon
</pre></div>
</div>
<p>To allowing WMS <code class="docutils literal notranslate"><span class="pre">REMOTE_OWS</span></code> data access to an external GeoServer WFS service:</p>
<p><code class="docutils literal notranslate"><span class="pre">^https://mapping\.server\.net/geoserver/(\w+/)?ows\?.*SERVICE=WFS.*$</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>https://mapping.server.net/geoserver/ows?SERVICE=WFS&amp;VERSION=1.0.0&amp;REQUEST=GetFeature&amp;TYPENAME=roads
</pre></div>
</div>
<p>To allow external graphic access to a remote GeoServer icons:</p>
<p><code class="docutils literal notranslate"><span class="pre">^https://mapping\.server\.net/geoserver/styles/.*(\?.*)?$</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>https://mapping.server.net/geoserver/styles/grass_fill.png
https://mapping.server.net/geoserver/styles/ne/airport.svg?fill=gray
</pre></div>
</div>
<p>File paths can also be checked:</p>
<p><code class="docutils literal notranslate"><span class="pre">^/var/opt/geoserver/data/.*$</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">geoserver</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">example</span><span class="o">.</span><span class="n">tiff</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">^D:\\\\data\\.*$</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">D</span><span class="p">:</span>\\<span class="n">data</span>\<span class="n">example</span><span class="o">.</span><span class="n">tiff</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The locations being checked are normalizedmaking it easier to write RegEx patterns:</p>
<ul class="simple">
<li><p>URLs paths have been normalized to remove any redundant <code class="docutils literal notranslate"><span class="pre">\.</span></code> or <code class="docutils literal notranslate"><span class="pre">\..</span></code> paths have been removed</p></li>
<li><p>File URLs have been normalized so that <code class="docutils literal notranslate"><span class="pre">file:/</span></code> is represented as <code class="docutils literal notranslate"><span class="pre">file:///</span></code></p></li>
<li><p>File paths have been normalized using <code class="docutils literal notranslate"><span class="pre">/</span></code> on linux and <code class="docutils literal notranslate"><span class="pre">\\</span></code> on windows</p></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Web sites are available to help define a valid Java regular expression pattern. These tools can be used to interpret, explain and test regular expressions. For example:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://regex101.com/">https://regex101.com/</a> (enable the Java 8 flavor)</p></li>
<li><p><a class="reference external" href="https://www.freeformatter.com/java-regex-tester.html">https://www.freeformatter.com/java-regex-tester.html</a></p></li>
</ul>
</div>
</div>
</div>


        <div class="selfclear pagination-nav">
            <div class="leftwise"><strong>Previous</strong>: <a href="rest.html" title="previous chapter">REST Security</a></div>
            <div class="rightwise"><strong>Next</strong>: <a href="disable.html" title="next chapter">Disabling security</a></div>
        </div>
        </div><!-- /#content> -->
        <div id="content-right" class="content-border"></div>
        
  <div id="sidebar" class="contrast">
      <div id="toc" class="section">
        <h3 class="pngfix"><a href="../index.html">Table Of Contents</a></h3>
        <ul>
<li><a class="reference internal" href="#">URL Checks</a><ul>
<li><a class="reference internal" href="#configuration-of-url-checks">Configuration of URL checks</a></li>
<li><a class="reference internal" href="#adding-a-regular-expression-based-check">Adding a regular expression based check</a></li>
<li><a class="reference internal" href="#removing-a-regular-expression-based-check">Removing a regular expression based check</a></li>
<li><a class="reference internal" href="#editing-a-url-check">Editing a URL Check</a></li>
<li><a class="reference internal" href="#testing-url-checks">Testing URL checks</a></li>
<li><a class="reference internal" href="#example-regex-patterns">Example RegEx Patterns</a></li>
</ul>
</li>
</ul>

        <div class="section-footer"></div>
      </div>
        <div class="section">
          <h3>Continue Reading</h3>
          <ul>
            <li>Previous: <a href="rest.html" title="previous chapter">REST Security</a></li>
            <li>Next: <a href="disable.html" title="next chapter">Disabling security</a></li>
          </ul>
        </div>
        <div class="section">
        <h3>This Page</h3>
        <ul class="this-page-menu">
        
        <li><a href="https://github.com/geoserver/geoserver/tree/main/doc/en/user/source/security/urlchecks.rst">Edit</a></li>
        </ul>
        </div>
      <div class="section">
        <h3>Known GeoServer issues</h3>
        <ul class="this-page-menu">
          <li><a href="https://osgeo-org.atlassian.net/projects/GEOS/summary">Jira issue tracker</a></li>
        </ul>
      </div>
  </div><!-- /#sidebar -->
    </div><!-- /.wrap> -->
  </div><!-- /#main -->
<div id="footer">
    <div class="wrap">
        &copy; Copyright 2023, Open Source Geospatial Foundation. License <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution</a>.
        Last updated on Jun 18, 2023.
        Created using <a href="http://www.sphinx-doc.org/">Sphinx</a>.
    </div><!-- /.wrap> -->
</div><!-- /#footer -->
  </body>
</html>