
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CSRF Protection &#8212; GeoServer 2.22.4 User Manual</title>
    <link rel="stylesheet" href="../../_static/blueprint/screen.css" type="text/css" media="screen, projection" />
    <link rel="stylesheet" href="../../_static/blueprint/print.css" type="text/css" media="print" /> 
    <!--[if IE]>
    <link rel="stylesheet" href="../../_static/blueprint/ie.css" type="text/css" media="screen, projection" />
    <![endif]-->
    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/default.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/geoserver.ico"/>
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Role system" href="../usergrouprole/index.html" />
    <link rel="prev" title="File Browsing" href="filebrowse.html" /> 
  </head><body class="security/webadmin/csrf">
<div id="header" class="selfclear">
    <div class="wrap selfclear">
        <div id="logo"><a href="http://geoserver.org">GeoServer</a></div>
        <ul id="top-nav">
            <li class="first"><a href="http://geoserver.org/about/">About</a></li>
            <li><a href="http://geoserver.org/blog">Blog</a></li>
            <li><a href="http://geoserver.org/download/">Download</a></li>
            <li><a href="https://docs.geoserver.org/">Documentation</a></li>
        </ul>

        <form id="quick-search" action="../../search.html" method="get">
            <fieldset>
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
                <input id="quick-search-query" type="text" name="q" accessKey="q" name="searchQuery.queryString" size="25" size="20" tabindex="3" placeholder="Search User Manual&hellip;" />
                <input id="quick-search-submit" type="image" value="Search" src="../../_static/chrome/search_icon_green.png" />
            </fieldset>
        </form>
    </div><!-- /.wrap -->
</div><!-- /#header -->
    <div id="main">
      <div class="wrap selfclear">
        <div id="content-left" class="content-border"></div>
        <div id="content">
        
<ul id="breadcrumbs">
  
    <li><a href="../../index.html">GeoServer 2.22.4 User Manual</a> &raquo;</li>
        <li><a href="../index.html" accesskey="U">Security</a> &raquo;</li>
        <li><a href="index.html" accesskey="U">Security settings</a> &raquo;</li>
    <li>CSRF Protection</li>
</ul>
        
<ul id="relatedlinks" class="selfclear">
  <li class="first"><a href="../usergrouprole/index.html" title="Role system" accesskey="N">Next</a></li>
  <li>
    <a href="filebrowse.html" title="File Browsing" accesskey="P">Previous</a>|
  </li>
</ul>
          
  <div class="section" id="csrf-protection">
<span id="security-webadmin-csrf"></span><h1>CSRF Protection<a class="headerlink" href="#csrf-protection" title="Permalink to this headline">¶</a></h1>
<p>The GeoServer web admin employs a CSRF (Cross-Site Request Forgery) protection filter that will block any form submissions that didn’t appear to originate from GeoServer. This can sometimes cause problems for certain proxy configurations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Symptoms of this problem may include the WPS request builder (and
other wicket pages) failing with an HTTP status of 403 and the message “Origin
does not correspond to request”. However, you may need to view the page
response in a debugger to see this, to the end user it will appear as if the
form section of the page is just missing.</p>
</div>
<p>To allow-list your proxy with the CSRF filter, you can use the <code class="docutils literal notranslate"><span class="pre">GEOSERVER_CSRF_WHITELIST</span></code> property. This property is a comma-separated list of domains, of the form <code class="docutils literal notranslate"><span class="pre">&lt;domainname&gt;.&lt;TLD&gt;</span></code>, and can contain a subdomains.
Alternatively, you can disable the CSRF filter by setting the <code class="docutils literal notranslate"><span class="pre">GEOSERVER_CSRF_DISABLED</span></code> property to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>Each of these properties is set through one of the standard means:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">web.xml</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">context</span><span class="o">-</span><span class="n">param</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">param</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span><span class="n">GEOSERVER_CSRF_WHITELIST</span><span class="o">&lt;/</span><span class="n">param</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">param</span><span class="o">-</span><span class="n">value</span><span class="o">&gt;</span><span class="n">example</span><span class="o">.</span><span class="n">org</span><span class="o">&lt;/</span><span class="n">param</span><span class="o">-</span><span class="n">value</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">context</span><span class="o">-</span><span class="n">param</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
<li><p>System property</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">DGEOSERVER_CSRF_WHITELIST</span><span class="o">=</span><span class="n">example</span><span class="o">.</span><span class="n">org</span>
</pre></div>
</div>
</li>
<li><p>Environment variable</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">GEOSERVER_CSRF_WHITELIST</span><span class="o">=</span><span class="n">example</span><span class="o">.</span><span class="n">org</span>
</pre></div>
</div>
</li>
</ul>
</div>


        <div class="selfclear pagination-nav">
            <div class="leftwise"><strong>Previous</strong>: <a href="filebrowse.html" title="previous chapter">File Browsing</a></div>
            <div class="rightwise"><strong>Next</strong>: <a href="../usergrouprole/index.html" title="next chapter">Role system</a></div>
        </div>
        </div><!-- /#content> -->
        <div id="content-right" class="content-border"></div>
        
  <div id="sidebar" class="contrast">
        <div class="section">
          <h3>Continue Reading</h3>
          <ul>
            <li>Previous: <a href="filebrowse.html" title="previous chapter">File Browsing</a></li>
            <li>Next: <a href="../usergrouprole/index.html" title="next chapter">Role system</a></li>
          </ul>
        </div>
        <div class="section">
        <h3>This Page</h3>
        <ul class="this-page-menu">
        
        <li><a href="https://github.com/geoserver/geoserver/tree/main/doc/en/user/source/security/webadmin/csrf.rst">Edit</a></li>
        </ul>
        </div>
      <div class="section">
        <h3>Known GeoServer issues</h3>
        <ul class="this-page-menu">
          <li><a href="https://osgeo-org.atlassian.net/projects/GEOS/summary">Jira issue tracker</a></li>
        </ul>
      </div>
  </div><!-- /#sidebar -->
    </div><!-- /.wrap> -->
  </div><!-- /#main -->
<div id="footer">
    <div class="wrap">
        &copy; Copyright 2023, Open Source Geospatial Foundation. License <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution</a>.
        Last updated on Jun 18, 2023.
        Created using <a href="http://www.sphinx-doc.org/">Sphinx</a>.
    </div><!-- /.wrap> -->
</div><!-- /#footer -->
  </body>
</html>